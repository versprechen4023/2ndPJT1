<?xml version="1.0" encoding="UTF-8"?>
<!DOCTYPE mapper
  PUBLIC "-//mybatis.org//DTD Mapper 3.0//EN"
  "https://mybatis.org/dtd/mybatis-3-mapper.dtd">
 <mapper namespace="mes.icemile.mappers.wareHouseCopyMapper">
  
  
  	<!-- 원자재 재고 리스트 -->
  	<select id="getRawStockList" resultType="ems.icemile.dto.StockDTO">
		SELECT s.stock_code, r.raw_name, r.raw_code, r.raw_type, r.raw_amount AS 'stock_status', 
       		   r.wh_code, s.stock_date
		FROM raw_material r LEFT JOIN stock s 
		ON r.raw_code = s.raw_code	
  	</select>
  	
  	
  	<!-- 원자재 재고 삽입 -->
	<insert id="insertRawStock" parameterType="ems.icemile.dto.StockDTO">
   	 	INSERT INTO stock(stock_code, raw_code, stock_date, stock_status, wh_code)
    	VALUES (CONCAT('ST', LPAD(#{stock_code}, 4, '0')), #{raw_code}, #{stock_date}, #{stock_status}, #{wh_code})
	</insert>
    
    
    <!-- 재고 코드 부여 -->
    <select id="getNewStockCode" resultType="int">
		SELECT count(*) + 1
		FROM stock
	</select>
	
	
	<update id="updateRawStock">
		UPDATE stock
		SET stock_amount = #{stock_amount}
		WHERE stock_code = #{stock_code}
	</update>

  
 </mapper>
  